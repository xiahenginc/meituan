<!DOCTYPE html>

<html>
    <head>      
       
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
        <link rel="stylesheet" type="text/css" href="css/index.css">
       
        <title></title>
    </head>
    <body>
        <img id="image" width="100%" height="100%" />
        <button id="qrbtn">扫描二维码</button>
        扫描到的二维码为：<div id="qrtxt"></div>
        <div id="fromswift">这里的文字是swift直接调用的</div>
        <button onclick="setimage()">选择图片</button>
        <script type="text/javascript">
            function setimage(){
                var x = document.getElementById("image")
                x.src = "http://localdevice/pic"
            }

            function connectWebViewJavascriptBridge(callback) {
                if (window.WebViewJavascriptBridge) {
                    callback(WebViewJavascriptBridge)
                } else {
                    document.addEventListener('WebViewJavascriptBridgeReady', function() {
                        callback(WebViewJavascriptBridge)
                    }, false)
                }
            }

            connectWebViewJavascriptBridge(function(bridge) {
                /*初始化代码,不管他*/
                bridge.init(function(message, responseCallback) {
                })
                 /*点击扫描二维码*/
                 var button = document.getElementById('qrbtn')
                   button.onclick = function(e) {
                   e.preventDefault();
                   bridge.send('qr', function responseCallback(responseData) {
                        var divtxt = document.getElementById('qrtxt')
                        divtxt.innerText = responseData
                    })
                }
                /*来自swift直接调用*/
               bridge.registerHandler('swiftcalljssample', function(data, responseCallback) {
                  var divtxt = document.getElementById('fromswift')
                  divtxt.innerText = data
                  responseCallback("jsreturntoswift")
                })
            })
                
        </script>
    </body>
</html>
